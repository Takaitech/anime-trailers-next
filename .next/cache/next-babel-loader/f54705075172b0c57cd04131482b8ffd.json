{"ast":null,"code":"import _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nvar _jsxFileName = \"/Users/takaitech/Takai-Tech/anime-trailers-next/components/Carousel.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext, useEffect, useRef } from \"react\";\nimport { FilterContext } from \"../contexts/FilterContext\";\nimport { SearchContext } from \"../contexts/SearchContext\";\nimport { AnimeContext } from \"../contexts/AnimeContext\";\nimport Anime from \"./Anime\";\nimport { device } from \"../devices\";\n\nconst Carousel = ({\n  topAnime\n}) => {\n  const {\n    0: anime,\n    1: setAnime\n  } = useState(topAnime);\n  const {\n    filter\n  } = useContext(FilterContext);\n  const {\n    query\n  } = useContext(SearchContext);\n  const {\n    selected,\n    dispatch\n  } = useContext(AnimeContext);\n  const carouselSelector = useRef();\n  const {\n    0: scrollProgress,\n    1: setScrollProgress\n  } = useState(\"0%\");\n\n  let getScrollPercent = () => {\n    return carouselSelector.current.scrollLeft / (carouselSelector.current.scrollWidth - carouselSelector.current.offsetWidth) * 100;\n  };\n\n  const {\n    0: isDown,\n    1: setIsDown\n  } = useState(false);\n  const {\n    0: startX,\n    1: setStartX\n  } = useState();\n  const {\n    0: scrollLeft,\n    1: setScrollLeft\n  } = useState();\n\n  let onMouseDown = e => {\n    setIsDown(true);\n    setStartX(e.pageX - carouselSelector.current.offsetLeft);\n    setScrollLeft(carouselSelector.current.scrollLeft);\n    let scrollPercent = getScrollPercent();\n    setScrollProgress(scrollPercent);\n  };\n\n  let onMouseLeave = e => {\n    setIsDown(false);\n  };\n\n  let onMouseUp = e => {\n    setIsDown(false);\n    let scrollPercent = getScrollPercent();\n    setScrollProgress(scrollPercent);\n  };\n\n  let onMouseMove = e => {\n    if (!isDown) return;\n    e.preventDefault();\n    const x = e.pageX;\n    const distance = (x - startX) * 3;\n    carouselSelector.current.scrollLeft = scrollLeft - distance;\n  };\n\n  let onTouchStart = e => {\n    let scrollPercent = getScrollPercent();\n    setScrollProgress(scrollPercent);\n  };\n\n  let onTouchEnd = e => {\n    let scrollPercent = getScrollPercent();\n    setScrollProgress(scrollPercent);\n  };\n\n  useEffect(() => {\n    const url = filter === \"top\" ? \"https://api.jikan.moe/v3/top/anime/1/bypopularity\" : \"https://api.jikan.moe/v3/top/anime/1/upcoming\";\n    fetch(url).then(response => response.json()).then(responseJson => setAnime(responseJson.top)).catch(err => console.log(err));\n  }, [filter]);\n  useEffect(() => {\n    if (query !== \"\") {\n      function formatQueryParams(params) {\n        const queryItems = _Object$keys(params).map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`);\n\n        return queryItems.join(\"&\");\n      }\n\n      const baseurl = \"https://api.jikan.moe/v3/search/anime\";\n      let params = {\n        q: query,\n        page: 1,\n        type: \"tv\",\n        limit: 10\n      };\n      let url = baseurl + \"?\" + formatQueryParams(params);\n      fetch(url).then(response => response.json()).then(responseJson => setAnime(responseJson.results)).catch(err => console.log(err));\n    }\n  }, [query]);\n  useEffect(() => {\n    dispatch({\n      type: \"SELECT_ANIME\",\n      selected: {}\n    });\n  }, [anime]);\n  return __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"569060357\", [scrollProgress + '%', device.laptop]]]) + \" \" + \"carouselWrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    ref: carouselSelector,\n    onMouseDown: e => onMouseDown(e),\n    onMouseLeave: e => onMouseLeave(e),\n    onMouseUp: e => onMouseUp(e),\n    onMouseMove: e => onMouseMove(e),\n    onTouchStart: e => onTouchStart(e),\n    onTouchEnd: e => onTouchEnd(e),\n    className: _JSXStyle.dynamic([[\"569060357\", [scrollProgress + '%', device.laptop]]]) + \" \" + `carousel ${isDown === true ? \"isDown\" : \"\"}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, anime.map((anime, index) => __jsx(Anime, {\n    key: index,\n    anime: anime,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"569060357\", [scrollProgress + '%', device.laptop]]]) + \" \" + \"scrollBar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }), __jsx(_JSXStyle, {\n    id: \"569060357\",\n    dynamic: [scrollProgress + '%', device.laptop],\n    __self: this\n  }, `.carouselWrapper.__jsx-style-dynamic-selector{width:100%;}.carousel.__jsx-style-dynamic-selector{cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:175px;max-width:100%;overflow-y:scroll;-webkit-overflow-scrolling:touch;}.carousel.__jsx-style-dynamic-selector{-ms-overflow-style:none;overflow:-moz-scrollbars-none;}.carousel.__jsx-style-dynamic-selector::-webkit-scrollbar{display:none;}.scrollBar.__jsx-style-dynamic-selector{width:${scrollProgress + '%'};height:2px;background-color:rgb(71,71,51);-webkit-transition:0.3s width;transition:0.3s width;}@media ${device.laptop}{.scrollBar.__jsx-style-dynamic-selector{-webkit-transition:0.5s width;transition:0.5s width;}}\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy90YWthaXRlY2gvVGFrYWktVGVjaC9hbmltZS10cmFpbGVycy1uZXh0L2NvbXBvbmVudHMvQ2Fyb3VzZWwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBd0hrQixBQUdzQixBQUlJLEFBU1MsQUFLWCxBQUlzQixBQVFQLFdBN0I5QixFQWtCQSxFQWRlLFNBU2lCLFdBU25CLFdBQ3NCLE1BUS9CLEVBakJKLHVCQVV3QixZQW5CTCxpQkFDRixlQUNHLFFBa0JwQixVQWpCbUMsaUNBQ25DIiwiZmlsZSI6Ii9Vc2Vycy90YWthaXRlY2gvVGFrYWktVGVjaC9hbmltZS10cmFpbGVycy1uZXh0L2NvbXBvbmVudHMvQ2Fyb3VzZWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBGaWx0ZXJDb250ZXh0IH0gZnJvbSBcIi4uL2NvbnRleHRzL0ZpbHRlckNvbnRleHRcIjtcbmltcG9ydCB7IFNlYXJjaENvbnRleHQgfSBmcm9tIFwiLi4vY29udGV4dHMvU2VhcmNoQ29udGV4dFwiO1xuaW1wb3J0IHsgQW5pbWVDb250ZXh0IH0gZnJvbSBcIi4uL2NvbnRleHRzL0FuaW1lQ29udGV4dFwiO1xuaW1wb3J0IEFuaW1lIGZyb20gXCIuL0FuaW1lXCI7XG5pbXBvcnQge2RldmljZX0gZnJvbSBcIi4uL2RldmljZXNcIlxuXG5jb25zdCBDYXJvdXNlbCA9ICh7IHRvcEFuaW1lIH0pID0+IHtcbiAgY29uc3QgW2FuaW1lLCBzZXRBbmltZV0gPSB1c2VTdGF0ZSh0b3BBbmltZSk7XG4gIGNvbnN0IHsgZmlsdGVyIH0gPSB1c2VDb250ZXh0KEZpbHRlckNvbnRleHQpO1xuICBjb25zdCB7IHF1ZXJ5IH0gPSB1c2VDb250ZXh0KFNlYXJjaENvbnRleHQpO1xuICBjb25zdCB7IHNlbGVjdGVkLCBkaXNwYXRjaCB9ID0gdXNlQ29udGV4dChBbmltZUNvbnRleHQpO1xuXG4gIGNvbnN0IGNhcm91c2VsU2VsZWN0b3IgPSB1c2VSZWYoKTtcbiAgY29uc3QgW3Njcm9sbFByb2dyZXNzLCBzZXRTY3JvbGxQcm9ncmVzc10gPSB1c2VTdGF0ZShcIjAlXCIpO1xuICAgIGxldCBnZXRTY3JvbGxQZXJjZW50ID0gKCkgPT4ge1xuICAgICAgIHJldHVybiAgKGNhcm91c2VsU2VsZWN0b3IuY3VycmVudC5zY3JvbGxMZWZ0IC9cbiAgICAgICAgICAgIChjYXJvdXNlbFNlbGVjdG9yLmN1cnJlbnQuc2Nyb2xsV2lkdGggLSBjYXJvdXNlbFNlbGVjdG9yLmN1cnJlbnQub2Zmc2V0V2lkdGgpKSAqIDEwMFxuICAgIH1cblxuICBjb25zdCBbaXNEb3duLCBzZXRJc0Rvd25dID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc3RhcnRYLCBzZXRTdGFydFhdID0gdXNlU3RhdGUoKTtcbiAgY29uc3QgW3Njcm9sbExlZnQsIHNldFNjcm9sbExlZnRdID0gdXNlU3RhdGUoKTtcblxuICBsZXQgb25Nb3VzZURvd24gPSBlID0+IHtcbiAgICBzZXRJc0Rvd24odHJ1ZSk7XG4gICAgc2V0U3RhcnRYKGUucGFnZVggLSBjYXJvdXNlbFNlbGVjdG9yLmN1cnJlbnQub2Zmc2V0TGVmdCk7XG4gICAgc2V0U2Nyb2xsTGVmdChjYXJvdXNlbFNlbGVjdG9yLmN1cnJlbnQuc2Nyb2xsTGVmdCk7XG4gICAgbGV0IHNjcm9sbFBlcmNlbnQgPSBnZXRTY3JvbGxQZXJjZW50KClcbiAgICBzZXRTY3JvbGxQcm9ncmVzcyhzY3JvbGxQZXJjZW50KTtcbiAgfTtcblxuICBsZXQgb25Nb3VzZUxlYXZlID0gZSA9PiB7XG4gICAgc2V0SXNEb3duKGZhbHNlKTtcbiAgfTtcblxuICBsZXQgb25Nb3VzZVVwID0gZSA9PiB7XG4gICAgc2V0SXNEb3duKGZhbHNlKTtcbiAgICBsZXQgc2Nyb2xsUGVyY2VudCA9IGdldFNjcm9sbFBlcmNlbnQoKVxuICAgIHNldFNjcm9sbFByb2dyZXNzKHNjcm9sbFBlcmNlbnQpO1xuICB9O1xuXG4gIGxldCBvbk1vdXNlTW92ZSA9IGUgPT4ge1xuICAgIGlmICghaXNEb3duKSByZXR1cm47XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IHggPSBlLnBhZ2VYO1xuICAgIGNvbnN0IGRpc3RhbmNlID0gKHggLSBzdGFydFgpICogMztcbiAgICBjYXJvdXNlbFNlbGVjdG9yLmN1cnJlbnQuc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQgLSBkaXN0YW5jZTtcbiAgIFxuICAgIFxuICB9O1xuXG4gIGxldCBvblRvdWNoU3RhcnQgPSBlID0+IHtcbiAgICAgICAgbGV0IHNjcm9sbFBlcmNlbnQgPSBnZXRTY3JvbGxQZXJjZW50KClcbiAgICAgICAgc2V0U2Nyb2xsUHJvZ3Jlc3Moc2Nyb2xsUGVyY2VudCk7XG4gIH1cblxuICBsZXQgb25Ub3VjaEVuZCA9IGUgPT4ge1xuICAgICAgICBsZXQgc2Nyb2xsUGVyY2VudCA9IGdldFNjcm9sbFBlcmNlbnQoKVxuICAgICAgICBzZXRTY3JvbGxQcm9ncmVzcyhzY3JvbGxQZXJjZW50KTtcbiAgfVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgdXJsID1cbiAgICAgIGZpbHRlciA9PT0gXCJ0b3BcIlxuICAgICAgICA/IFwiaHR0cHM6Ly9hcGkuamlrYW4ubW9lL3YzL3RvcC9hbmltZS8xL2J5cG9wdWxhcml0eVwiXG4gICAgICAgIDogXCJodHRwczovL2FwaS5qaWthbi5tb2UvdjMvdG9wL2FuaW1lLzEvdXBjb21pbmdcIjtcbiAgICBmZXRjaCh1cmwpXG4gICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgICAudGhlbihyZXNwb25zZUpzb24gPT4gc2V0QW5pbWUocmVzcG9uc2VKc29uLnRvcCkpXG4gICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xuICB9LCBbZmlsdGVyXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAocXVlcnkgIT09IFwiXCIpIHtcbiAgICAgIGZ1bmN0aW9uIGZvcm1hdFF1ZXJ5UGFyYW1zKHBhcmFtcykge1xuICAgICAgICBjb25zdCBxdWVyeUl0ZW1zID0gT2JqZWN0LmtleXMocGFyYW1zKS5tYXAoXG4gICAgICAgICAga2V5ID0+IGAke2VuY29kZVVSSUNvbXBvbmVudChrZXkpfT0ke2VuY29kZVVSSUNvbXBvbmVudChwYXJhbXNba2V5XSl9YFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gcXVlcnlJdGVtcy5qb2luKFwiJlwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYmFzZXVybCA9IFwiaHR0cHM6Ly9hcGkuamlrYW4ubW9lL3YzL3NlYXJjaC9hbmltZVwiO1xuICAgICAgbGV0IHBhcmFtcyA9IHtcbiAgICAgICAgcTogcXVlcnksXG4gICAgICAgIHBhZ2U6IDEsXG4gICAgICAgIHR5cGU6IFwidHZcIixcbiAgICAgICAgbGltaXQ6IDEwXG4gICAgICB9O1xuXG4gICAgICBsZXQgdXJsID0gYmFzZXVybCArIFwiP1wiICsgZm9ybWF0UXVlcnlQYXJhbXMocGFyYW1zKTtcbiAgICAgIGZldGNoKHVybClcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuICAgICAgICAudGhlbihyZXNwb25zZUpzb24gPT4gc2V0QW5pbWUocmVzcG9uc2VKc29uLnJlc3VsdHMpKVxuICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xuICAgIH1cbiAgfSwgW3F1ZXJ5XSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBkaXNwYXRjaCh7IHR5cGU6IFwiU0VMRUNUX0FOSU1FXCIsIHNlbGVjdGVkOiB7fSB9KTtcbiAgfSwgW2FuaW1lXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImNhcm91c2VsV3JhcHBlclwiPlxuICAgICAgPGRpdlxuICAgICAgICBjbGFzc05hbWU9e2BjYXJvdXNlbCAke2lzRG93biA9PT0gdHJ1ZSA/IFwiaXNEb3duXCIgOiBcIlwifWB9XG4gICAgICAgIHJlZj17Y2Fyb3VzZWxTZWxlY3Rvcn1cbiAgICAgICAgb25Nb3VzZURvd249e2UgPT4gb25Nb3VzZURvd24oZSl9XG4gICAgICAgIG9uTW91c2VMZWF2ZT17ZSA9PiBvbk1vdXNlTGVhdmUoZSl9XG4gICAgICAgIG9uTW91c2VVcD17ZSA9PiBvbk1vdXNlVXAoZSl9XG4gICAgICAgIG9uTW91c2VNb3ZlPXtlID0+IG9uTW91c2VNb3ZlKGUpfVxuICAgICAgICBvblRvdWNoU3RhcnQ9e2UgPT4gb25Ub3VjaFN0YXJ0KGUpfVxuICAgICAgICBvblRvdWNoRW5kPXtlID0+IG9uVG91Y2hFbmQoZSl9XG5cbiAgICAgID5cbiAgICAgICAge2FuaW1lLm1hcCgoYW5pbWUsIGluZGV4KSA9PiAoXG4gICAgICAgICAgPEFuaW1lIGtleT17aW5kZXh9IGFuaW1lPXthbmltZX0gLz5cbiAgICAgICAgKSl9XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2Nyb2xsQmFyXCI+PC9kaXY+XG4gICAgICA8c3R5bGUganN4PntgXG4gICAgICAgIC5jYXJvdXNlbFdyYXBwZXIge1xuICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICB9XG5cbiAgICAgICAgLmNhcm91c2VsIHtcbiAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBtaW4taGVpZ2h0OiAxNzVweDtcbiAgICAgICAgICBtYXgtd2lkdGg6IDEwMCU7XG4gICAgICAgICAgb3ZlcmZsb3cteTogc2Nyb2xsOyAvKiBoYXMgdG8gYmUgc2Nyb2xsLCBub3QgYXV0byAqL1xuICAgICAgICAgIC13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOiB0b3VjaDtcbiAgICAgICAgfVxuXG4gICAgICAgIC5jYXJvdXNlbCB7XG4gICAgICAgICAgLW1zLW92ZXJmbG93LXN0eWxlOiBub25lOyAvLyBJRSAxMCtcbiAgICAgICAgICBvdmVyZmxvdzogLW1vei1zY3JvbGxiYXJzLW5vbmU7IC8vIEZpcmVmb3hcbiAgICAgICAgfVxuXG4gICAgICAgIC5jYXJvdXNlbDo6LXdlYmtpdC1zY3JvbGxiYXIge1xuICAgICAgICAgIGRpc3BsYXk6IG5vbmU7IC8vIFNhZmFyaSBhbmQgQ2hyb21lXG4gICAgICAgIH1cblxuICAgICAgICAuc2Nyb2xsQmFyIHtcbiAgICAgICAgICB3aWR0aDogJHtzY3JvbGxQcm9ncmVzcyArICclJ307XG4gICAgICAgICAgaGVpZ2h0OiAycHg7XG4gICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDcxLCA3MSwgNTEpO1xuICAgICAgICAgIHRyYW5zaXRpb246IDAuM3Mgd2lkdGg7XG4gICAgICAgIH1cblxuICAgICAgICBAbWVkaWEgJHtkZXZpY2UubGFwdG9wfSB7XG4gICAgICAgICAgICAuc2Nyb2xsQmFyIHtcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiAwLjVzIHdpZHRoO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IENhcm91c2VsO1xuIl19 */\n/*@ sourceURL=/Users/takaitech/Takai-Tech/anime-trailers-next/components/Carousel.js */`));\n};\n\nexport default Carousel;","map":{"version":3,"sources":["/Users/takaitech/Takai-Tech/anime-trailers-next/components/Carousel.js"],"names":["React","useState","useContext","useEffect","useRef","FilterContext","SearchContext","AnimeContext","Anime","device","Carousel","topAnime","anime","setAnime","filter","query","selected","dispatch","carouselSelector","scrollProgress","setScrollProgress","getScrollPercent","current","scrollLeft","scrollWidth","offsetWidth","isDown","setIsDown","startX","setStartX","setScrollLeft","onMouseDown","e","pageX","offsetLeft","scrollPercent","onMouseLeave","onMouseUp","onMouseMove","preventDefault","x","distance","onTouchStart","onTouchEnd","url","fetch","then","response","json","responseJson","top","catch","err","console","log","formatQueryParams","params","queryItems","map","key","encodeURIComponent","join","baseurl","q","page","type","limit","results","laptop","index"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect, useRef } from \"react\";\nimport { FilterContext } from \"../contexts/FilterContext\";\nimport { SearchContext } from \"../contexts/SearchContext\";\nimport { AnimeContext } from \"../contexts/AnimeContext\";\nimport Anime from \"./Anime\";\nimport {device} from \"../devices\"\n\nconst Carousel = ({ topAnime }) => {\n  const [anime, setAnime] = useState(topAnime);\n  const { filter } = useContext(FilterContext);\n  const { query } = useContext(SearchContext);\n  const { selected, dispatch } = useContext(AnimeContext);\n\n  const carouselSelector = useRef();\n  const [scrollProgress, setScrollProgress] = useState(\"0%\");\n    let getScrollPercent = () => {\n       return  (carouselSelector.current.scrollLeft /\n            (carouselSelector.current.scrollWidth - carouselSelector.current.offsetWidth)) * 100\n    }\n\n  const [isDown, setIsDown] = useState(false);\n  const [startX, setStartX] = useState();\n  const [scrollLeft, setScrollLeft] = useState();\n\n  let onMouseDown = e => {\n    setIsDown(true);\n    setStartX(e.pageX - carouselSelector.current.offsetLeft);\n    setScrollLeft(carouselSelector.current.scrollLeft);\n    let scrollPercent = getScrollPercent()\n    setScrollProgress(scrollPercent);\n  };\n\n  let onMouseLeave = e => {\n    setIsDown(false);\n  };\n\n  let onMouseUp = e => {\n    setIsDown(false);\n    let scrollPercent = getScrollPercent()\n    setScrollProgress(scrollPercent);\n  };\n\n  let onMouseMove = e => {\n    if (!isDown) return;\n    e.preventDefault();\n    const x = e.pageX;\n    const distance = (x - startX) * 3;\n    carouselSelector.current.scrollLeft = scrollLeft - distance;\n   \n    \n  };\n\n  let onTouchStart = e => {\n        let scrollPercent = getScrollPercent()\n        setScrollProgress(scrollPercent);\n  }\n\n  let onTouchEnd = e => {\n        let scrollPercent = getScrollPercent()\n        setScrollProgress(scrollPercent);\n  }\n\n  useEffect(() => {\n    const url =\n      filter === \"top\"\n        ? \"https://api.jikan.moe/v3/top/anime/1/bypopularity\"\n        : \"https://api.jikan.moe/v3/top/anime/1/upcoming\";\n    fetch(url)\n      .then(response => response.json())\n      .then(responseJson => setAnime(responseJson.top))\n      .catch(err => console.log(err));\n  }, [filter]);\n\n  useEffect(() => {\n    if (query !== \"\") {\n      function formatQueryParams(params) {\n        const queryItems = Object.keys(params).map(\n          key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`\n        );\n        return queryItems.join(\"&\");\n      }\n\n      const baseurl = \"https://api.jikan.moe/v3/search/anime\";\n      let params = {\n        q: query,\n        page: 1,\n        type: \"tv\",\n        limit: 10\n      };\n\n      let url = baseurl + \"?\" + formatQueryParams(params);\n      fetch(url)\n        .then(response => response.json())\n        .then(responseJson => setAnime(responseJson.results))\n        .catch(err => console.log(err));\n    }\n  }, [query]);\n\n  useEffect(() => {\n    dispatch({ type: \"SELECT_ANIME\", selected: {} });\n  }, [anime]);\n\n  return (\n    <div className=\"carouselWrapper\">\n      <div\n        className={`carousel ${isDown === true ? \"isDown\" : \"\"}`}\n        ref={carouselSelector}\n        onMouseDown={e => onMouseDown(e)}\n        onMouseLeave={e => onMouseLeave(e)}\n        onMouseUp={e => onMouseUp(e)}\n        onMouseMove={e => onMouseMove(e)}\n        onTouchStart={e => onTouchStart(e)}\n        onTouchEnd={e => onTouchEnd(e)}\n\n      >\n        {anime.map((anime, index) => (\n          <Anime key={index} anime={anime} />\n        ))}\n      </div>\n      <div className=\"scrollBar\"></div>\n      <style jsx>{`\n        .carouselWrapper {\n          width: 100%;\n        }\n\n        .carousel {\n          cursor: pointer;\n          display: flex;\n          min-height: 175px;\n          max-width: 100%;\n          overflow-y: scroll; /* has to be scroll, not auto */\n          -webkit-overflow-scrolling: touch;\n        }\n\n        .carousel {\n          -ms-overflow-style: none; // IE 10+\n          overflow: -moz-scrollbars-none; // Firefox\n        }\n\n        .carousel::-webkit-scrollbar {\n          display: none; // Safari and Chrome\n        }\n\n        .scrollBar {\n          width: ${scrollProgress + '%'};\n          height: 2px;\n          background-color: rgb(71, 71, 51);\n          transition: 0.3s width;\n        }\n\n        @media ${device.laptop} {\n            .scrollBar {\n                transition: 0.5s width;\n\n            }\n        }\n      `}</style>\n    </div>\n  );\n};\n\nexport default Carousel;\n"]},"metadata":{},"sourceType":"module"}