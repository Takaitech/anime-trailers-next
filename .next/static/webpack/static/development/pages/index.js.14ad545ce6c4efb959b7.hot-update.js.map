{"version":3,"file":"static/webpack/static/development/pages/index.js.14ad545ce6c4efb959b7.hot-update.js","sources":["webpack:///./components/Carousel.js"],"sourcesContent":["import React, { useState, useContext, useEffect, useRef} from 'react'\nimport { FilterContext } from '../contexts/FilterContext'\nimport { SearchContext } from '../contexts/SearchContext'\nimport { AnimeContext } from '../contexts/AnimeContext'\nimport Anime from './Anime'\n\n\n\nconst Carousel = ({topAnime}) => {\n\n    const [anime, setAnime] = useState(topAnime)\n    const {filter} = useContext(FilterContext)\n    const {query} = useContext(SearchContext)\n    const {selected, dispatch} = useContext(AnimeContext)\n    \n    const [scrollPercent, setScrollPercent] = useState('0%')\n    const carouselSelector = useRef()\n\n    const [isDown, setIsDown] = useState(false)\n    const [startX, setStartX] = useState()\n    const [scrollLeft, setScrollLeft] = useState()\n\n    let onMouseDown = (e) => {\n        setIsDown(true)\n        setStartX(e.pageX - carouselSelector.current.offsetLeft) \n        setScrollLeft(carouselSelector.current.scrollLeft)\n        \n    }\n\n    let onMouseLeave = (e) => {\n        setIsDown(false)\n\n    }\n\n    let onMouseUp = (e) => {\n        setIsDown(false)\n\n    }\n\n    let onMouseMove = (e) => {\n        if(!isDown) return\n        e.preventDefault()\n        const x = e.pageX\n        const distance = (x - startX) * 2.5\n        carouselSelector.current.scrollLeft =  (scrollLeft - distance)  \n        setScrollPercent((carouselSelector.current.scrollLeft / (carouselSelector.current.scrollWidth - carouselSelector.current.offsetWidth)) * 100 )\n    }\n\n    useEffect(() => {\n        const url = filter === 'top' ? 'https://api.jikan.moe/v3/top/anime/1/bypopularity' : 'https://api.jikan.moe/v3/top/anime/1/upcoming'\n        fetch(url)\n        .then(response => response.json())\n        .then(responseJson => setAnime(responseJson.top))\n        .catch(err => console.log(err) )\n    },[filter])\n    \n\n    useEffect(() => { \n        if(query !== '') {\n            function formatQueryParams(params) {\n                const queryItems = Object.keys(params)\n                .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`)\n                return queryItems.join('&');\n            }\n            \n            const baseurl = 'https://api.jikan.moe/v3/search/anime';\n            let params = {\n                q: query,\n                page: 1,\n                type: 'tv',\n                limit: 10,\n            };\n            \n            let url = baseurl + '?' + formatQueryParams(params);\n            fetch(url)\n            .then(response => response.json())\n            .then(responseJson => setAnime(responseJson.results))\n            .catch(err => console.log(err) )\n\n        }\n    },[query])\n\n    useEffect(() => {\n        dispatch({type:'SELECT_ANIME', selected: {}})\n    },[anime])\n\n\n    return (\n        <div className={`carousel ${isDown === true ? 'isDown' : \"\"}`}\n            ref={carouselSelector}\n            onMouseDown={(e) => onMouseDown(e)} \n            onMouseLeave={(e) => onMouseLeave(e)} \n            onMouseUp={(e) => onMouseUp(e)} \n            onMouseMove={(e) => onMouseMove(e)}>\n            {anime.map((anime,index) => (\n                <Anime key={index} anime={anime} />\n            ))}\n            <div className=\"scrollBar\"></div>\n            <style jsx>{`\n            .carousel {\n                cursor: pointer;\n                display: flex;\n                min-height: 175px;\n                max-width: 100%;\n                overflow-y: scroll; /* has to be scroll, not auto */\n                -webkit-overflow-scrolling: touch;\n                padding-bottom: 5px;\n                border-bottom: 6px solid rgb(0,0,0);\n\n            }\n\n            .carousel {\n                -ms-overflow-style: none;  // IE 10+\n                overflow: -moz-scrollbars-none;  // Firefox\n            }\n            \n            .carousel::-webkit-scrollbar {\n                display: none; // Safari and Chrome\n            }\n\n            .scrollBar {\n                height: 6px;\n                background-color: rgb(51,51,51)\n            }\n\n            `}</style>\n        </div>\n    )\n}\n\nexport default Carousel\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAGA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAOA;AACA;AATA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAaA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAGA;AACA;AAAA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAGA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AATA;AAAA;AAAA;AAwCA;AACA;AACA;;;;A","sourceRoot":""}